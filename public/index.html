<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>CRM API test for The Agile Monkeys</title>
  <style>
    code {
      white-space: pre-wrap;
    }

    span.smallcaps {
      font-variant: small-caps;
    }

    span.underline {
      text-decoration: underline;
    }

    div.column {
      display: inline-block;
      vertical-align: top;
      width: 50%;
    }

    div.hanging-indent {
      margin-left: 1.5em;
      text-indent: -1.5em;
    }

    ul.task-list {
      list-style: none;
    }

    pre>code.sourceCode {
      white-space: pre;
      position: relative;
    }

    pre>code.sourceCode>span {
      display: inline-block;
      line-height: 1.25;
    }

    pre>code.sourceCode>span:empty {
      height: 1.2em;
    }

    code.sourceCode>span {
      color: inherit;
      text-decoration: inherit;
    }

    div.sourceCode {
      margin: 1em 0;
    }

    pre.sourceCode {
      margin: 0;
    }

    @media screen {
      div.sourceCode {
        overflow: auto;
      }
    }

    @media print {
      pre>code.sourceCode {
        white-space: pre-wrap;
      }

      pre>code.sourceCode>span {
        text-indent: -5em;
        padding-left: 5em;
      }
    }

    pre.numberSource code {
      counter-reset: source-line 0;
    }

    pre.numberSource code>span {
      position: relative;
      left: -4em;
      counter-increment: source-line;
    }

    pre.numberSource code>span>a:first-child::before {
      content: counter(source-line);
      position: relative;
      left: -1em;
      text-align: right;
      vertical-align: baseline;
      border: none;
      display: inline-block;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      padding: 0 4px;
      width: 4em;
      color: #aaaaaa;
    }

    pre.numberSource {
      margin-left: 3em;
      border-left: 1px solid #aaaaaa;
      padding-left: 4px;
    }

    div.sourceCode {}

    @media screen {
      pre>code.sourceCode>span>a:first-child::before {
        text-decoration: underline;
      }
    }

    code span.al {
      color: #ff0000;
      font-weight: bold;
    }

    /* Alert */
    code span.an {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    /* Annotation */
    code span.at {
      color: #7d9029;
    }

    /* Attribute */
    code span.bn {
      color: #40a070;
    }

    /* BaseN */
    code span.bu {}

    /* BuiltIn */
    code span.cf {
      color: #007020;
      font-weight: bold;
    }

    /* ControlFlow */
    code span.ch {
      color: #4070a0;
    }

    /* Char */
    code span.cn {
      color: #880000;
    }

    /* Constant */
    code span.co {
      color: #60a0b0;
      font-style: italic;
    }

    /* Comment */
    code span.cv {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    /* CommentVar */
    code span.do {
      color: #ba2121;
      font-style: italic;
    }

    /* Documentation */
    code span.dt {
      color: #902000;
    }

    /* DataType */
    code span.dv {
      color: #40a070;
    }

    /* DecVal */
    code span.er {
      color: #ff0000;
      font-weight: bold;
    }

    /* Error */
    code span.ex {}

    /* Extension */
    code span.fl {
      color: #40a070;
    }

    /* Float */
    code span.fu {
      color: #06287e;
    }

    /* Function */
    code span.im {}

    /* Import */
    code span.in {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    /* Information */
    code span.kw {
      color: #007020;
      font-weight: bold;
    }

    /* Keyword */
    code span.op {
      color: #666666;
    }

    /* Operator */
    code span.ot {
      color: #007020;
    }

    /* Other */
    code span.pp {
      color: #bc7a00;
    }

    /* Preprocessor */
    code span.sc {
      color: #4070a0;
    }

    /* SpecialChar */
    code span.ss {
      color: #bb6688;
    }

    /* SpecialString */
    code span.st {
      color: #4070a0;
    }

    /* String */
    code span.va {
      color: #19177c;
    }

    /* Variable */
    code span.vs {
      color: #4070a0;
    }

    /* VerbatimString */
    code span.wa {
      color: #60a0b0;
      font-weight: bold;
      font-style: italic;
    }

    /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>

<body>
  <h1 id="crm-api-test-for-the-agile-monkeys">CRM API test for The Agile Monkeys</h1>
  <figure>
    <img src="https://davsanchez.semaphoreci.com/badges/theam_test_crm_api/branches/develop.svg?style=shields" alt="" />
    <figcaption>Build status</figcaption>
  </figure>
  <p>This repo contains my proposed solution to <strong>API Test - The CRM Service</strong> by <strong>The Agile
      Monkeys</strong>. It is written in <strong>Go</strong>.</p>
  <h2 id="app-features">App features</h2>
  <h3 id="architecture">Architecture</h3>
  <p>The solution proposed makes use of a <a href="https://www.postgresql.org">PostgreSQL database</a> provided by <a
      href="https://hub.docker.com/_/postgres/">its Docker image</a>, as part of a multi-container application managed
    with Docker Compose. The database feeds the API backend service, coded in Go, that is also enabled to run as a
    Docker container built from <a href="https://hub.docker.com/_/golang/">its official image</a>.</p>
  <p>This configuration makes possible to setup the whole architecture with one command, provided Docker is installed,
    executed from the project’s root directory:</p>
  <div class="sourceCode" id="cb1">
    <pre
      class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="ex">docker-compose</span> up -d --build</span></code></pre>
  </div>
  <p>Where the option <code>-d</code> makes <code>docker-compose</code> run in detached mode and <code>--build</code>
    rebuilds the Go backend in case changes were made since the last setup.</p>
  <p>To shutdown the whole architecture, a similar command needs to be used from the project’s root directory:</p>
  <pre><code>docker-compose down</code></pre>
  <p>This will stop all the containers but won’t remove the volumes defined for them. Thus, the database contents will
    be persisted in its volume for the next time it is run.</p>
  <figure>
    <img src="theamTestArch.png" title="Project architecture" alt="" />
    <figcaption>Project architecture</figcaption>
  </figure>
  <p>As the above diagram suggest, it is possible to run other backends external to the Docker container architecture,
    provided the different configuration parameters needed (backend port, database host and ports…) are taken into
    account.</p>
  <p>A stand-alone version of the backend is also running on <a href="https://www.heroku.com/">Heroku</a>, hooked to the
    GitHub repository’s <code>heroku</code> branch and using the PostgreSQL database available in the SaaS platform’s
    free tier. You can make requests to the available endpoints (see <a href="#API_endpoints">below</a>) at host <a
      href="https://theam-crm-api.herokuapp.com/"><code>https://theam-crm-api.herokuapp.com/</code></a> (remember to
    login first :)).</p>
  <p>The following libraries were used for the backend development: - <code>gorilla/mux</code>: Provides the route
    handling via its HTTP request multiplexer. - <code>lib/pq</code>: Go database driver for PostgreSQL. -
    <code>crypto/bcrypt</code>: Cryptographic library for hashing and comparing passwords. -
    <code>dgrijalva/jwt-go</code>: Go implementation of JSON Web Tokens (JWT)</p>
  <h2 id="api-endpoints"><a name="API_endpoints"></a>API endpoints</h2>
  <p>The API was implemented making use of <code>gorilla/mux</code>’s router, which allow matches incoming requests
    against a list of registered routes and calls a handler for the route that matches the URL or other conditions. All
    API endpoints return a JSON object, the details below define its content for each endpoint.</p>
  <p>For detailing the possible request inputs, conditions and outputs of the API endpoints, the following syntax is
    used:</p>
  <pre><code>(&lt;condition?) &lt;input?&gt; -&gt; &lt;response&gt;</code></pre>
  <p>For the HTTP requests, if any URL segment is a parameter, it will be enclosed in curly braces,
    <code>{variable}</code>, in the title and represented as <code>variable</code> in the example responses. For the
    example JSON responses, only descriptive values are used. No numeric value can be below <code>1</code>.</p>
  <h3 id="customers">Customers</h3>
  <h4 id="get-customersall"><code>GET /customers/all</code></h4>
  <p>Endpoint for getting a list of all customers in the system.</p>
  <div class="sourceCode" id="cb4">
    <pre
      class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1"></a>(No customers) <span class="op">-&gt;</span> []</span>
<span id="cb4-2"><a href="#cb4-2"></a>(<span class="dv">1</span><span class="op">+</span> customers) <span class="op">-&gt;</span> [</span>
<span id="cb4-3"><a href="#cb4-3"></a>    {</span>
<span id="cb4-4"><a href="#cb4-4"></a>        <span class="st">&quot;id&quot;</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>        <span class="st">&quot;name&quot;</span><span class="op">:</span><span class="st">&quot;Customer_1_name&quot;</span><span class="op">,</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>        <span class="st">&quot;surname&quot;</span><span class="op">:</span><span class="st">&quot;Customer_1_surname&quot;</span><span class="op">,</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>        <span class="st">&quot;picturePath&quot;</span><span class="op">:</span><span class="st">&quot;/path/to/picture.ext&quot;</span><span class="op">,</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>        <span class="st">&quot;createdBy&quot;</span><span class="op">:</span><span class="st">&quot;creatorUser&quot;</span><span class="op">,</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>        <span class="st">&quot;lastModifiedByUser&quot;</span><span class="op">:</span><span class="st">&quot;modificatorUser&quot;</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>    }<span class="op">,</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="co">// ... (If more than 1 customer)</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>]</span>
<span id="cb4-13"><a href="#cb4-13"></a>(<span class="bu">Error</span>) <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span> <span class="st">&quot;error_message&quot;</span>}</span></code></pre>
  </div>
  <!-- #### Possible endpoint improvements
// TODO -->
  <h4 id="get-customerscustomerid"><code>GET /customers/{customerId}</code></h4>
  <p>Endpoint for getting the customer of a specific <code>customerId</code>.</p>
  <div class="sourceCode" id="cb5">
    <pre
      class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1"></a>(Existing customerId) <span class="op">-&gt;</span> {</span>
<span id="cb5-2"><a href="#cb5-2"></a>        <span class="st">&quot;id&quot;</span><span class="op">:</span>customerId<span class="op">,</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>        <span class="st">&quot;name&quot;</span><span class="op">:</span><span class="st">&quot;Customer_1_name&quot;</span><span class="op">,</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>        <span class="st">&quot;surname&quot;</span><span class="op">:</span><span class="st">&quot;Customer_1_surname&quot;</span><span class="op">,</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>        <span class="st">&quot;picturePath&quot;</span><span class="op">:</span><span class="st">&quot;/path/to/picture.ext&quot;</span><span class="op">,</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>        <span class="st">&quot;createdBy&quot;</span><span class="op">:</span><span class="st">&quot;creatorUser&quot;</span><span class="op">,</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>        <span class="st">&quot;lastModifiedByUser&quot;</span><span class="op">:</span><span class="st">&quot;modificatorUser&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>}</span>
<span id="cb5-9"><a href="#cb5-9"></a>(No customers) <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;Customer not found&quot;</span>}</span>
<span id="cb5-10"><a href="#cb5-10"></a>(<span class="bu">Error</span>) <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;error_message&quot;</span>}</span></code></pre>
  </div>
  <h4 id="post-customerscreate"><code>POST /customers/create</code></h4>
  <p>Endpoint for creating a specific user in the system. This relies on having uploaded an image first (or not at all,
    in that case the <code>"pictureId"</code> field can be omitted) so the path is shown in the result.</p>
  <div class="sourceCode" id="cb6">
    <pre
      class="sourceCode js"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1"></a>(Created successfully) {</span>
<span id="cb6-2"><a href="#cb6-2"></a>        <span class="st">&quot;name&quot;</span><span class="op">:</span><span class="st">&quot;Customer_1_name&quot;</span><span class="op">,</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>        <span class="st">&quot;surname&quot;</span><span class="op">:</span><span class="st">&quot;Customer_1_surname&quot;</span><span class="op">,</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>        <span class="st">&quot;pictureId&quot;</span><span class="op">:</span>pictureId<span class="op">,</span> <span class="co">// Or omitted</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>} <span class="op">-&gt;</span> {</span>
<span id="cb6-6"><a href="#cb6-6"></a>        <span class="st">&quot;id&quot;</span><span class="op">:</span><span class="dv">2</span><span class="op">,</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>        <span class="st">&quot;name&quot;</span><span class="op">:</span><span class="st">&quot;Customer_2_name&quot;</span><span class="op">,</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>        <span class="st">&quot;surname&quot;</span><span class="op">:</span><span class="st">&quot;Customer_2_surname&quot;</span><span class="op">,</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>        <span class="st">&quot;picturePath&quot;</span><span class="op">:</span><span class="st">&quot;/path/to/picture.ext&quot;</span><span class="op">,</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>        <span class="st">&quot;createdBy&quot;</span><span class="op">:</span><span class="st">&quot;creatorUser&quot;</span><span class="op">,</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>        <span class="st">&quot;lastModifiedByUser&quot;</span><span class="op">:</span><span class="st">&quot;creatorUser&quot;</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>}</span>
<span id="cb6-13"><a href="#cb6-13"></a>(<span class="bu">Error</span>) <span class="op">*</span> <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;error_message&quot;</span>}</span></code></pre>
  </div>
  <h4 id="put-customerscustomerid"><code>PUT /customers/{customerId}</code></h4>
  <p>Endpoint for updating a specific user in the system. This relies on having uploaded an image first (or not at all,
    in that case the <code>"pictureId"</code> field can be omitted) so the path is shown in the result.</p>
  <div class="sourceCode" id="cb7">
    <pre
      class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1"></a>(Updated successfully) {</span>
<span id="cb7-2"><a href="#cb7-2"></a>        <span class="st">&quot;name&quot;</span><span class="op">:</span><span class="st">&quot;Updated_customer_1_name&quot;</span><span class="op">,</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>        <span class="st">&quot;surname&quot;</span><span class="op">:</span><span class="st">&quot;Updated_customer_1_surname&quot;</span><span class="op">,</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>        <span class="st">&quot;pictureId&quot;</span><span class="op">:</span>pictureId<span class="op">,</span> <span class="co">// Or omitted</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>} <span class="op">-&gt;</span> {</span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="st">&quot;id&quot;</span><span class="op">:</span>customerId<span class="op">,</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>        <span class="st">&quot;name&quot;</span><span class="op">:</span><span class="st">&quot;Updated_customer_1_name&quot;</span><span class="op">,</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>        <span class="st">&quot;surname&quot;</span><span class="op">:</span><span class="st">&quot;Updated_customer_1_surname&quot;</span><span class="op">,</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>        <span class="st">&quot;picturePath&quot;</span><span class="op">:</span><span class="st">&quot;/path/to/picture.ext&quot;</span><span class="op">,</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>        <span class="st">&quot;createdBy&quot;</span><span class="op">:</span><span class="st">&quot;creatorUser&quot;</span><span class="op">,</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>        <span class="st">&quot;lastModifiedByUser&quot;</span><span class="op">:</span><span class="st">&quot;userWhoMadeTheRequest&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>}</span>
<span id="cb7-13"><a href="#cb7-13"></a>(Nonexistent {customerId}) <span class="op">*</span> <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;No customer was updated&quot;</span>}</span>
<span id="cb7-14"><a href="#cb7-14"></a>(<span class="bu">Error</span>) <span class="op">*</span> <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;error_message&quot;</span>}</span></code></pre>
  </div>
  <h4 id="delete-customerscustomerid"><code>DELETE /customers/{customerId}</code></h4>
  <p>Endpoint for deleting a specific user in the system.</p>
  <div class="sourceCode" id="cb8">
    <pre
      class="sourceCode js"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1"></a>(Deleted successfully) <span class="op">*</span> <span class="op">-&gt;</span> {<span class="st">&quot;result&quot;</span><span class="op">:</span><span class="st">&quot;success&quot;</span>}</span>
<span id="cb8-2"><a href="#cb8-2"></a>(Nonexistent {customerId}) <span class="op">*</span> <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;No customer was deleted&quot;</span>}</span>
<span id="cb8-3"><a href="#cb8-3"></a>(<span class="bu">Error</span>) <span class="op">*</span> <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;error_message&quot;</span>}</span></code></pre>
  </div>
  <h3 id="pictures">Pictures</h3>
  <h4 id="get-customerspicturepictureid"><code>GET /customers/picture/{pictureId}</code></h4>
  <p>Endpoint for getting the picture path of a specific <code>pictureId</code>.</p>
  <div class="sourceCode" id="cb9">
    <pre
      class="sourceCode js"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1"></a>(Existing pictureId) <span class="op">-&gt;</span> {</span>
<span id="cb9-2"><a href="#cb9-2"></a>        <span class="st">&quot;id&quot;</span><span class="op">:</span>pictureId<span class="op">,</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>        <span class="st">&quot;picturePath&quot;</span><span class="op">:</span><span class="st">&quot;picture/id/path&quot;</span><span class="op">,</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>}</span>
<span id="cb9-5"><a href="#cb9-5"></a>(No picture) <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;Picture not found&quot;</span>}</span>
<span id="cb9-6"><a href="#cb9-6"></a>(<span class="bu">Error</span>) <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;error_message&quot;</span>}</span></code></pre>
  </div>
  <h4 id="post-customerspictureupload"><code>POST /customers/picture/upload</code></h4>
  <p>Endpoint for uploading picture to the system.</p>
  <div class="sourceCode" id="cb10">
    <pre
      class="sourceCode js"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1"></a>(Uploaded and stored successfully) [image_multipart_form] <span class="op">-&gt;</span> {</span>
<span id="cb10-2"><a href="#cb10-2"></a>        <span class="st">&quot;id&quot;</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>        <span class="st">&quot;picturePath&quot;</span><span class="op">:</span><span class="st">&quot;picture/id/path.ext&quot;</span><span class="op">,</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>}</span>
<span id="cb10-5"><a href="#cb10-5"></a>(<span class="bu">Error</span>) <span class="op">*</span> <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;error_message&quot;</span>}</span></code></pre>
  </div>
  <h3 id="user-authentication-and-authorization">User authentication and authorization</h3>
  <p>The whole <code>/customer</code> endpoints are behind an authentication middleware that uses JWT. To be able to
    make requests to these endpoints, you must set the <code>Authorization</code> header to
    <code>"Bearer {token}"</code>, where <code>{token}</code> is the value of the field with the same name on a
    successful response to <code>/users/login</code> (see below). Otherwise, all responses will be
    <code>Unauthorized</code> (or <code>Bad request</code> if the request payload is malformed) with their corresponding
    HTTP codes.</p>
  <h4 id="post-usersregister"><code>POST /users/register</code></h4>
  <p>Endpoint for registering a new user. The <code>"username"</code> values must be unique</p>
  <div class="sourceCode" id="cb11">
    <pre
      class="sourceCode js"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1"></a>(Valid user) {</span>
<span id="cb11-2"><a href="#cb11-2"></a>        <span class="st">&quot;username&quot;</span><span class="op">:</span><span class="st">&quot;userName&quot;</span><span class="op">,</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>        <span class="st">&quot;password&quot;</span><span class="op">:</span><span class="st">&quot;password&quot;</span><span class="op">,</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>} <span class="op">-&gt;</span> {<span class="st">&quot;result&quot;</span><span class="op">:</span> <span class="st">&quot;success&quot;</span>}</span>
<span id="cb11-5"><a href="#cb11-5"></a>(Password less than <span class="dv">12</span> characters) <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span> <span class="st">&quot;Password less than 12 characters&quot;</span>}</span>
<span id="cb11-6"><a href="#cb11-6"></a>(<span class="bu">Error</span>) <span class="op">*</span> <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;error_message&quot;</span>}</span></code></pre>
  </div>
  <h4 id="post-userslogin"><code>POST /users/login</code></h4>
  <p>Endpoint for user login and session token retrieval. The token has a expiration time set to 5 minutes.</p>
  <div class="sourceCode" id="cb12">
    <pre
      class="sourceCode js"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1"></a>(Valid user) {</span>
<span id="cb12-2"><a href="#cb12-2"></a>        <span class="st">&quot;username&quot;</span><span class="op">:</span><span class="st">&quot;userName&quot;</span><span class="op">,</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>        <span class="st">&quot;password&quot;</span><span class="op">:</span><span class="st">&quot;password&quot;</span><span class="op">,</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>} <span class="op">-&gt;</span> {<span class="st">&quot;result&quot;</span><span class="op">:</span> <span class="st">&quot;success&quot;</span><span class="op">,</span> <span class="st">&quot;token&quot;</span><span class="op">:</span> tokenString}</span>
<span id="cb12-5"><a href="#cb12-5"></a>(<span class="bu">Error</span> verificating user) <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span> <span class="st">&quot;Invalid credentials&quot;</span>}</span>
<span id="cb12-6"><a href="#cb12-6"></a>(<span class="bu">Error</span>) <span class="op">*</span> <span class="op">-&gt;</span> {<span class="st">&quot;error&quot;</span><span class="op">:</span><span class="st">&quot;error_message&quot;</span>}</span></code></pre>
  </div>
  <h2 id="further-improvements">Further improvements</h2>
  <h3 id="database-pre-populating">Database pre-populating</h3>
  <p>At this moment, the database table creation and pre-populating with a placeholder image path and an administrator
    user is done at <code>db/db.go</code>, being part of the backend execution. This is should be done somewhere else,
    be it mouting a directory with the <code>sql</code> files to <code>/docker-entrypoint-initdb.d/</code> at the
    PostgreSQL Docker image, which initializes it if the database is empty, or using other environment-specific methods
    available.</p>
  <h3 id="better-error-handling">Better error handling</h3>
  <p>At this moment many of the errors that can occur are simply printed to the standard logger (stoppping the erroring
    operation where it makes sense, of course) and in case it’s needed they are used as a response to API requests. This
    needs some polish.</p>
  <h3 id="more-testing">More testing</h3>
  <p>At the time of writing this there is an <em>E2E</em> or system test at <code>main_test.go</code> that uses the
    whole API in different situations (authenticated, not authenticated, invalid customers and users, etc). It’s not
    fully exhaustive, but it tests several behaviours of every endpoint. There are not unit tests for every package yet.
    It’s good practice to include unit tests for every function in each of the individual packages, and I’ll try to add
    them soon.</p>
  <h3 id="https">HTTPS</h3>
  <p>Of course. Let’s Encrypt and everything. With a little bit of time I’ll implement that too.</p>
  <h3 id="and-much-more">… and much more!</h3>
  <p>I mean, this is being done in less than a week, while working full time and with a world-spanning viral crisis in
    full force! Sure there is room for improvement :)</p>
</body>

</html>